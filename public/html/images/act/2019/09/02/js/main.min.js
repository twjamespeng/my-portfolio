$(function(){(new WOW).init();moment.locale("zh-tw");var b=moment().format("Y"),e=moment().format("MM"),c=moment().format("DD"),h=moment().format("dddd"),k=function(b){var d,a=decodeURIComponent(window.location.search.substring(1)).toString().split("?").toString().split("&");for(d=0;d<a.length;d++){var c=a[d].split("=");if(c[0]===b)return void 0===c[d]?!0:c[1]}},l=k("m"),g=k("d");g&&l&&(c=g,e=l,h=moment(b+e+c).format("dddd"));console.log("year:"+b);console.log("month:"+e);console.log("date:"+c);console.log("day:"+
h);$("body").append('<div class="d-flex flex-column align-items-center flexcontainer animated fadeIn"><div class="d-flex flex-row"><div class="v-left"></div><div class="v-right"></div><div class="v-head"><div class="t-year">'+b+'</div><div class="t-month">'+e+'<span>\u6708</span></div><div class="t-date">'+c+'</div><div class="t-day">'+h+'</div><div class="v-start-month"></div><div class="v-start-date"></div><div class="v-end-month"></div><div class="v-end-date"></div></div></div><div id="fiw" class="feature-item-wrapper"></div><div class="all-item-wrapper"><div id="ai" class="d-flex flew-row flex-wrap all-item"></div></div></div>');
g&&$(".v-head").append('<div id="cap-1" class="capture" title="\u64f7\u5716"><i class="fa fa-camera" aria-hidden="true"></i></div>');$.ajax({type:"get",url:"images/vsv/xml/"+b+e+".html",dataType:"xml",success:function(f){var d=[];$(f).find("item").each(function(){var a=$(this);a={year:moment($(this).find("pDate").text()).format("YYYY"),month:moment($(this).find("pDate").text()).format("MM"),date:moment($(this).find("pDate").text()).format("DD"),id:a.find("pId").text(),brand:a.find("pBrand").text(),
name:a.find("pName").text(),text:a.find("pText").text(),mprice:a.find("pMPrice").text(),vprice:a.find("pVPrice").text(),discount:(a.find("pVPrice").text()/a.find("pMPrice").text()*10).toFixed(1),d100:a.find("pD100").text(),imageurl:"https://www.vivatv.com.tw/Product.go?itemCode="+a.find("pId").text()};if(a.date===c){$("#fiw").append('<div class="feature-item"><div id="p'+a.id+'" class="feature-item-clicker"><div class="feature-discount">'+a.discount+'<span>\u6298</span></div><div class="feature-brand">'+
a.brand+'</div><div class="feature-name">'+a.name+'</div><div class="feature-text"><ul></ul></div><div class="feature-price"><span class="market-price"><span class="txt">\u5e02\u50f9</span><span class="dollar-sign">$</span>'+a.mprice+'</span><span class="viva-price"><span class="txt">\u6436\u8cfc\u50f9</span><span class="dollar-sign">$</span>'+a.vprice+'</span></div><div class="feature-image"><img title="'+a.brand+" "+a.name+'" class="img-responsive" src="images/vsv/product/'+a.year+"/"+a.month+"/"+
a.id+'.jpg"></div></div></div>');var b=a.text.split("\u25ce");for(i=1;i<b.length;i++)0<=b[i].indexOf("\u52a0\u78bc")||0<=b[i].indexOf("\u8d08")&&1==i?$("#p"+a.id+" .feature-text ul").append('<li class="gift">\u25cf '+b[i]+"</li>"):$("#p"+a.id+" .feature-text ul").append("<li>\u25cf "+b[i]+"</li>");100==a.d100&&$("#p"+a.id).append('<div class="feature-d100"></div>')}a.date<=c&&a.month==e?$("#ai").append('<div class="item"><div class="i-date"><span class="i-date-m">'+a.month+'</span><span class="i-date-d">'+
a.date+'</span></div><div class="i-image"><a target="_blank" href="https://www.vivatv.com.tw/Product.go?itemCode='+a.id+'"><img title="'+a.brand+" "+a.name+'" class="img-responsive" src="images/vsv/product/'+a.year+"/"+a.month+"/"+a.id+'.jpg"></a></div><div class="i-name"><span class="i-name-b">'+a.brand+'</span><span class="i-name-n">'+a.name+'</span></div><div class="i-discount"><span>'+a.discount+'</span></div><div class="i-price">'+a.vprice+"</div></div>"):a.date>c&&a.month==e&&$("#ai").append('<div class="item"><div class="i-date"><span class="i-date-m">'+
a.month+'</span><span class="i-date-d">'+a.date+'</span></div><div class="i-comingsoon"></div>');d.push(a)});g&&($(".feature-item:first-child").append('<div id="cap-2" class="capture" title="\u64f7\u5716"><i class="fa fa-camera" aria-hidden="true"></i></div>'),$(".feature-item:last-child").append('<div id="cap-3" class="capture" title="\u64f7\u5716"><i class="fa fa-camera" aria-hidden="true"></i></div>'));$("#cap-2").click(function(){html2canvas($(".feature-item:first-child"),{letterRendering:!0,
onrendered:function(a){a=a.toDataURL("image/jpeg",1);$("<a>",{href:a,download:b+e+c+"act_02.jpg"}).on("click",function(){$(this).remove()}).appendTo("body")[0].click()}})});$("#cap-3").click(function(){html2canvas($(".feature-item:last-child"),{letterRendering:!0,onrendered:function(a){a=a.toDataURL("image/jpeg",1);$("<a>",{href:a,download:b+e+c+"act_03.jpg"}).on("click",function(){$(this).remove()}).appendTo("body")[0].click()}})});$(".feature-item-clicker").click(function(){url=$(this).attr("id").substring(1);
window.open("https://www.vivatv.com.tw/Product.go?itemCode="+url)});c>d[d.length-1].date||c<d[0].date||e!=d[0].month?($("#fiw").hide(),$(".all-item-wrapper").hide()):($(".v-start-month").text(d[0].month),$(".v-start-date").text(d[0].date),$(".v-end-month").text(d[0].month),$(".v-end-date").text(d[d.length-1].date))},error:function(){$("#fiw").hide();$(".all-item-wrapper").hide()}});$("#cap-1").click(function(){html2canvas($(".v-head"),{letterRendering:!0,onrendered:function(f){f=f.toDataURL("image/jpeg",
1);$("<a>",{href:f,download:b+e+c+"act_01.jpg"}).on("click",function(){$(this).remove()}).appendTo("body")[0].click()}})})});function scrollToAnchor(b){b=$("#"+b);$("html,body").animate({scrollTop:b.offset().top},"slow")}$(".to24h").click(function(){scrollToAnchor("clock-24")});