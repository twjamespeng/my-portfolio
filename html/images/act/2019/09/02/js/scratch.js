(function() {
  
  'use strict';
  
  var isDrawing, lastPoint;
  var container    = document.getElementById('js-container'),
      canvas       = document.getElementById('js-canvas'),
      canvasWidth  = canvas.width,
      canvasHeight = canvas.height,
      ctx          = canvas.getContext('2d'),
      image        = new Image(),
      brush        = new Image();
      
  // base64 Workaround because Same-Origin-Policy
  image.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAycAAALHCAYAAACUmj2fAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjJDODZGOEQ1MDI4MzExRTlCM0JFRTU1QzlGQkU2NkY4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjJDODZGOEQ2MDI4MzExRTlCM0JFRTU1QzlGQkU2NkY4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MkM4NkY4RDMwMjgzMTFFOUIzQkVFNTVDOUZCRTY2RjgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MkM4NkY4RDQwMjgzMTFFOUIzQkVFNTVDOUZCRTY2RjgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7rpP0gAAAwXElEQVR42uzdfYzc9X3g8a+fHzAxtvEDJgbs2JjaAlyww0EbZEGAuAFULlACUdJT/uByTQ81cDEgBZWoSAFSSISKlEskpKblISq69AInCg0oQge+gAEbY8DEPBsnfraxvX5YP9x8fnims+N52tnZmdn16yVNsL3r9ezM7ub3nu/TkP/y9a+ncs6Yk9KUE1Pasy+lAwdSOnw49dqQIZ/+9+DBlG669Z/+R+6XP0wAAMBA8t377vr63w8d2vgHiC4YPjylMaNSeumv/qni+w3trzDJEyYAADCg/TCu5w8davwDRE9EV0RfVDO0BWHyXWECAAACJfqi7jhpZpjEHT8SJvd4LgEAYHAFSn4JR28Dpa44ESYAAEB/B0rNOIkwmTo5pb3CBAAAqCNQYglHsw3Pj5h07W1NmEwYPzb94sFL0yX/+XhPKwAAdKB/+1870/XffDpt29FVLVCG3HfX13/Yl128Sg1t5VSuCJO//talaU93Lkz2etIBAKDj5K7T9+eu1/8qd90e1+9V3BPX/31ZJH9UnLQ6TCZNOj5t3ZbS+vc87wAA0GnWvZOy6/XJk1ofKENbHSZhx86U1kacHPTkAwBAx8hdn7/7wafX66HVgTK01WFSKLI/pLR3o+cfAAA6RVyff/T7nn8WgfLXLQqUhpev9CVMws5dKb35O18AAADQKeL6fNfuo/98UgOB0sg2w72Kk/w/0NcwCfu7U9qxyxcAAAB0irg+j+v0cloRKEN+fM/XexUmsZ9xX8MkthsbOeLT25p3Utq4yRcCAAC005TJKc393KdxErdKU7S2bNmZ/uEnVbcZDktjm+Fhw45e375m6T9V/EvDvnTJ2XXHSX+EyQbrTgAAoO12705p7/6Upp6Yu/bP/f7Q4fIbZ40dOyqdOX9GWvX6h2nvvu5KH+6Sp3792p5LLz77+dLRky3//lrF+1D3tK4jYbJUmAAAwOAU1+dxnT7iyDV7pQMW65zidXf0Q28WydcVJ0fWmESY3C1MAABg8AfKyDYESs04ESYAACBQWhEoQ4UJAADQCYFScUF8XWFywnHCBAAABqniRfJZI9RaJL/6o7R3b/VF8otSer5XcVJ3mPzXS4QJAAAIlE8DZd5nawbK8pQqBspRcSJMAACAdgRKjzgRJgAAQK1AqXkOSoOBUoiTZoXJKGECAACDOlCmNC9Q9hYHShYnzQyTEcIEAAAGdaDs2ZfS1Mmf/r6PgfLF4kAZdunFZzd1Ktdba1PauMmTBgAAgzZQuvonUGI0RpgAAAC9NiUXJ2fMTml/96e3SueYbNmyM/3D//z3tG377mof7tZhuf/5v8IEAADorWaPoESc3FHuLSfkwuS/CxMAAKBZgTJ/Rnrt9cqBMrTSP3LZFy9J+w8cn3buFCYAAEBl0QPRBflGGFqmMqIr9u0fly675NKKH2d4pTcc2rYzfbjvYBo1fnwaP35ImjA+aiel0aOFCQAAcHSghFiDEmINyt69KXV1pbRtR0o7dhxO+3bsSAfjD3obJ925v3Rgz57sA+wZNy5tzd2O+8yoNHFCSrNnChMAAKByoHy4LqWt21La/cm+tH/nztS9e3c6fOBAOlxuzletOAnxFw93d6d927al7l270t6tI9Ou7SekAwfGpI2bPfgAAECZQMn1x/oPuz4dKdm/Px3q7q7r7w6v9x+JDxi3IcOG5cJkjEcdAAAoHyibU9q/a1c2WtIbQz10AABAJxAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAACAOAEAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAABAnAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAA4gQAAECcAAAAiBMAAECcAAAAiBMAAECcAAAAiBMAAECcAAAAiBMAAECcAAAAiBMAAECcAAAAiBMAAECcAAAAiBMAAECcAAAAiBMAAECcAAAAiBMAAECc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';
  image.onload = function() {
    ctx.drawImage(image, 0, 0);
    // Show the form when Image is loaded.
    // document.querySelectorAll('.form')[0].style.visibility = 'visible';
  };
  brush.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAxCAYAAABNuS5SAAAKFklEQVR42u2aCXCcdRnG997NJtlkk83VJE3apEma9CQlNAR60UqrGSqW4PQSO9iiTkE8BxWtlGMqYCtYrLRQtfVGMoJaGRFliijaViwiWgQpyCEdraI1QLXG52V+n/5nzd3ENnX/M8/sJvvt933/533e81ufL7MyK7NOzuXPUDD0FQCZlVn/+xUUQhkXHny8M2TxGsq48MBjXdAhL9/7YN26dd5nI5aVRrvEc0GFEBNKhbDjwsHh3qP/FJK1EdYIedOFlFAOgREhPlICifZDYoBjTna3LYe4xcI4oSpNcf6RvHjuAJRoVszD0qFBGmgMChipZGFxbqzQkJWVZUSOF7JRX3S4LtLTeyMtkkqljMBkPzHRs2aYY5PcZH/qLY1EIo18byQ6hBytIr3WCAXcV4tQHYvFxg3w3N6+Bh3OQolEoqCoqCinlw16JzTFJSE6PYuZKqvztbC2ex7bzGxhKu+rerjJrEEq+r9ieElJSXFDQ0Mh9zYzOzu7FBUWcO4Q9xbD6HYvhXhGLccVD5ZAPyfMqaioyOrBUgEv8FZXV8caGxtz8vLykhCWTnZIKmsKhUJnEYeKcKk2YYERH41G7UYnck1/WvAPOxsdLJm2+bEY0Ay0RNeqkytXQkoBZM4U5oOaoYSUkBGRtvnesrBZK4e4F6ypqSkuLy+v4KI99ZQxkfc6vZ4jNAl1wkbhG8LrhfNBCdkxmhYacvj/GOce+3K9MHHbDHUmicOufREELRIWch/DljzMsglutr+VIJO5KjGrVfZAnpF8mnCd8G5hrnC60Cl8T/iw8C1hKd9P9eDCMcgo5HwBx8BB/g7xeRPkrBbeJ3xTeAxjvRGVV3NcshfPG1JX4tVDQae47GuVOknCi23xHr5nyrxe2C1sFlYJ7xe+Jlwm7BRulItP0ms957RzTMK1ws41jMS8eDxehopaOCYfxc3AIHcIX+K6nxW+ImyVF1i8PQ8DTuwtdC1atCja3NwcHkq5EuXmo85G+jq+yMm28V4q/zcIPxV+K9zPxnbgTi0ocybu6wX66fx/vfAB4T1gHt8xI1wlXMF5zEXnQKC56ruEjwhvEa4WrrXvK/Yt5Pt5I1UveeVKyKmT+lpG2gQ2npMmez8ZzFT3e+HXwj7hKXNf6rFZbDpJUjESLdFsFX4mfFv4Fd/7qPBm4UPCJ4RNwncwym4UfYVUtiAcDk/T+3NRmylwWzAY7BCBCwYYogZPnrJoRNm2IDc3tw4FVKXFm95UmGLzkTTFpog524WnhQPCQeGvwiPCCuFCYmk5GbEJt3tOeF54HPVeLLyXxHOv8BPhYaFLeFU4gsI7OWeZk3g+hpJNvVMGIIqhdRvy+biVISouq2TBqWxoIL1wgBhU5AR1SzJvFR4UnhX+Bl4RfsFGP0npUkTymIQ7fh8Cf4l6F0LgXkj6o3O+buGfwj+ElzGQETaNeJqPhxiahckYq8KJ9V6mP+4pTIATjsGCA8lCQVy9VbhB2CM8itu9IBxlkx6O4nbmmpcSi0KUExa3Psfn23DZC4lhlhRuIWs/R1Y9BrpR4WHcfiOq34bLl5DJm1B7BANPGO4+2OJfDcVwX+RZkL5d+DRqeRJ360IJx1CFp4w/8/lhVGXxay1xKp8asQ31rSbgz2az1aBBWCZsgKTfEFe7uM4xYus9KHWXcBv3eolwJe67hJLIN6yubMVpW1tbbllZWVxtzjRquvQe9981IG3RZHUQttH7hB8IP0cdLwp/YnNHcdsjEP1xsEruO56i2Fy3UWXMskAgYAH/EjOiCD6NDc/XZ4v12RqSy3WQ9rJD3jPClwkZz2Aoy8JnUEjPcwYWfgfHvcIW84h308mABQP4Xp02OY44M4tSZSfx7UXIewU3NpXuxw0vJzauYDP1XM8y8Ttx67fhylYrdlAMW1x7h/BF3NWI+4PwFwjbSha26/xQuBmib6HDqeI+m4m5wzrj9A/xO+O5qbm4yizcbDOKfAjVWeC/WzAFLSeI+4hN9WzQ65EvED7D8Tt4vwE33O64rIfD1JW3k6xeQoX3UN6chyG8In4tcbHuRAyKw2ktVIIM2U5XcA7t2FKy5vWQeBexbbrTpvmZiJwN6e3EwKspW/ajqBuAKfKQk8m7KIce5bgnMNQDkLWPUmkj511DSVV5HJOd417FzrDAK7RjZLMZiURigmLVFCYs5tI2PFhpcUj/n6z6sp72LwJKiU2rUdp62rA7IX4XytpJ3Weh4XfE1/0kk/uoFX8kbCHudZLld5E8vJIs2+mbT8iznaR60DHMBt0EE1DySVlSsOBvyrL6zkZG5qI2T/QSBYTHMYAlq2tw1+0MFO4kVj5GSbSbgvkA8fQQr1uIdfdD5mZ1GhZbP0XfuwlPmOp0SNkYbkQV2JdlEsq69VJS+rTER+NtZVC+TX+NRFq1XGeiHXbGUHMg6lk2/DiZ+mHU8wTueoTXLtS3F5e9l2PNZW9lyrOB5LGSmJokzMQ6OjqCA3wsMXLLhqrWoZgKe3lyZ5YtLiwsLLfMLhJL0ibW3rKa7oMQ+Ajq6gKHcMeHeP8qZcpRMvyt1J97SRabcNP1ZGsbKhSb6lF+5GR6shUnlqTSyPM7LZxV/PUqjOfTH6cvqx+XyN3aCfBPUWh3UZIcxC2/jgu/BJ7Eve/G1R/EXS9gaLCc0dgySqIm7jV4MhEYdAaN4R4eRHkBusJp3GNp56iSOscyYN0DaUch8Ai13X6yrg0PvotCO8nme0geKymBaulc1qO+NbxOOpHZtrcHR+nT6+wePvcnk8k8qv6iNBdyH4/OoGR5gXbv75D4NIX3NoruLSjtKmLlbTwCKER1NmV+QIqfS13aai0izUHsRKksAQE5g0w4fuehj9f+xb25Ym1tbcIhuw2COmkBn2cAcQAFbsclV1BTns49JZio3EQWPkgCySJpFIu8aor0UfeLigDTlUTa/8eimhRGuUiKOZPYtYNabh9EGik3Mkk+A9I8JTWoAiik/LEpzY8tY4uwWc4AJMjxQd8oXRHU8JqbW32orNyAiubZo0WR5wX9KyHrLpLD52nrxhFHa1CVV5w3081cRu/7BYichpEqfafA7/sCzhT7tVkhLZvhTeB8Gv1r6U+ty/gqtWHQCSNTcPOl9NmXM1S4hgRjBjjL1MdUJ8cx3uhe3d3dfh5Meb8qyKWsuJRidwtN/h20XEtxvTwya7tKncU8ACqmXVwLict5fy6TnFhra2uW7xT8dWk2BHptVBOx8GLKjo3g7bhrBQq1sdVsCvEkhLZIac1y/zmUSO0oO8fX/0P2Ub3cwaWpZSITnLnOpDlBWTIfMleJqFb10jXCBJUlMyORSIP14LhqNef6v/05bpZTdHulUyXKsufDNdRxZ4vIhSKwhQFG5vfLfcwZsx2X92Jhje8/P8OI+TK/oO+zeA84WTzkvI/6RuB3y6f68qf11xnyMiuzMms4178AwArmZmkkdGcAAAAASUVORK5CYII=';
  
  canvas.addEventListener('mousedown', handleMouseDown, false);
  canvas.addEventListener('touchstart', handleMouseDown, false);
  canvas.addEventListener('mousemove', handleMouseMove, false);
  canvas.addEventListener('touchmove', handleMouseMove, false);
  canvas.addEventListener('mouseup', handleMouseUp, false);
  canvas.addEventListener('touchend', handleMouseUp, false);
  
  function distanceBetween(point1, point2) {
    return Math.sqrt(Math.pow(point2.x - point1.x, 2) + Math.pow(point2.y - point1.y, 2));
  }
  
  function angleBetween(point1, point2) {
    return Math.atan2( point2.x - point1.x, point2.y - point1.y );
  }
  
  // Only test every `stride` pixel. `stride`x faster,
  // but might lead to inaccuracy
  function getFilledInPixels(stride) {
    if (!stride || stride < 1) { stride = 1; }
    
    var pixels   = ctx.getImageData(0, 0, canvasWidth, canvasHeight),
        pdata    = pixels.data,
        l        = pdata.length,
        total    = (l / stride),
        count    = 0;
    
    // Iterate over all pixels
    for(var i = count = 0; i < l; i += stride) {
      if (parseInt(pdata[i]) === 0) {
        count++;
      }
    }
    
    return Math.round((count / total) * 100);
  }
  
  function getMouse(e, canvas) {
    var offsetX = 0, offsetY = 0, mx, my;
    var scrollVal = $(window).scrollTop();
    console.log(scrollVal);
    if (canvas.offsetParent !== undefined) {
      do {
        offsetX += canvas.offsetLeft;
        offsetY += canvas.offsetTop;
      } while ((canvas = canvas.offsetParent));
    }

    mx = (e.pageX || e.touches[0].clientX) - offsetX;
    my = (e.pageY || e.touches[0].clientY) - offsetY - scrollVal;

    return {x: mx, y: my};
  }
  
  function handlePercentage(filledInPixels) {
    filledInPixels = filledInPixels || 0;
    console.log(filledInPixels + '%');
    if (filledInPixels > 30) {
      canvas.parentNode.removeChild(canvas);
    }
  }
  
  function handleMouseDown(e) {
    isDrawing = true;
    lastPoint = getMouse(e, canvas);
  }

  function handleMouseMove(e) {
    if (!isDrawing) { return; }
    
    e.preventDefault();

    var currentPoint = getMouse(e, canvas),
        dist = distanceBetween(lastPoint, currentPoint),
        angle = angleBetween(lastPoint, currentPoint),
        x, y;
    
    for (var i = 0; i < dist; i++) {
      x = lastPoint.x + (Math.sin(angle) * i) - 25;
      y = lastPoint.y + (Math.cos(angle) * i) - 25;
      ctx.globalCompositeOperation = 'destination-out';
      ctx.drawImage(brush, x, y);
    }
    
    lastPoint = currentPoint;
    handlePercentage(getFilledInPixels(32));
  }

  function handleMouseUp(e) {
    isDrawing = false;
  }
  
})();